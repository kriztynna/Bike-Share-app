{% extends "base.html" %}
    {% block head %}
        <title>bike share app</title>
    {% endblock %}
	
    {%block body%}
        <h1>station history</h1>
            <p>this page shows the historical data for one station, {{name}}</p>
            <form action="/history" method="post">
                <select name="station_req" onchange="this.form.submit()">
                    {% for s in stations %}
                        {% set sel="" %}
                        {% if s.station_id == station_req %}
                            {% set sel="selected" %}
                        {% endif %}
                        <option value={{s.station_id}} {{sel}}>{{s.name}}</option>
                    {% endfor %}
                </select>
                <select name="time_req" onchange="this.form.submit()">
                    {% for t in timespans %}
                        {% set sel="" %}
                        {% if t[1] == time_req %}
                            {% set sel="selected" %}
                        {% endif %}
                        <option value={{t[1]}} {{sel}}>{{t[0]}}</option>
                    {% endfor %}
                </select>
                <label class="checkbox">
                    <input type="checkbox" name="bikes_req" value="checked" {{bikes_req}}>
                    Available bikes
                </label>
                <label class="checkbox">
                    <input type="checkbox" name="docks_req" value="checked" {{docks_req}}>
                    Available docks
                </label>
                <input type="submit" value="Submit">
            </form>
	    <hr>
	    <div id="chart_div"></div>

        <!-- JavaScript -->
        <script type="text/javascript" src="https://www.google.com/jsapi"></script>
        <script type="text/javascript">
            google.load('visualization', '1.0', {'packages':['corechart']});
            google.setOnLoadCallback(drawChart);
            function drawChart() {
                var data = new google.visualization.DataTable();
                    data.addColumn('datetime', 'Time');
                    {% if bikes_req == "checked" %}
                        data.addColumn('number', 'Available bikes');
                    {% endif %}
                    {% if docks_req == "checked" %}
                        data.addColumn('number', 'Available docks');
                    {% endif %}
                    {% for d in data_set %}
                        data.addRows([[{{d[0]}}, {{d[1]}}, {{d[2]}} ]]);
                    {% endfor %}                                              
                var options = {
                    title:'Available bikes at {{name|safe}}',
                    colors: ['#4ECDC4', '#FF6B6B', '#556270', '#C7F464', '#C44D58'], 
                    width:1000,
                    height:500,
                    };
                // color palette: "cheer up emo kid" by electrikmonk at ColourLovers
                // available at http://www.colourlovers.com/palette/1930/cheer_up_emo_kid
                
                var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
                chart.draw(data, options);
            }
        </script>

    {% endblock %}